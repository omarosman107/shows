!function(a,b){"function"==typeof define&&define.amd?define([],b):"object"==typeof exports?module.exports=b():a.X2JS=b()}(this,function(){return function(a){"use strict";function c(){void 0===a.escapeMode&&(a.escapeMode=!0),a.attributePrefix=a.attributePrefix||"_",a.arrayAccessForm=a.arrayAccessForm||"none",a.emptyNodeForm=a.emptyNodeForm||"text",void 0===a.enableToStringFunc&&(a.enableToStringFunc=!0),a.arrayAccessFormPaths=a.arrayAccessFormPaths||[],void 0===a.skipEmptyTextNodesForObj&&(a.skipEmptyTextNodesForObj=!0),void 0===a.stripWhitespaces&&(a.stripWhitespaces=!0),a.datetimeAccessFormPaths=a.datetimeAccessFormPaths||[],void 0===a.useDoubleQuotes&&(a.useDoubleQuotes=!1),a.xmlElementsFilter=a.xmlElementsFilter||[],a.jsonPropertiesFilter=a.jsonPropertiesFilter||[],void 0===a.keepCData&&(a.keepCData=!1)}function e(){}function f(a){var b=a.localName;return null==b&&(b=a.baseName),null!=b&&""!=b||(b=a.nodeName),b}function g(a){return a.prefix}function h(a){return"string"==typeof a?a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"):a}function j(a,b,c,d){for(var e=0;e<a.length;e++){var f=a[e];if("string"==typeof f){if(f==d)break}else if(f instanceof RegExp){if(f.test(d))break}else if("function"==typeof f&&f(b,c,d))break}return e!=a.length}function k(b,c,d){switch(a.arrayAccessForm){case"property":b[c]instanceof Array?b[c+"_asArray"]=b[c]:b[c+"_asArray"]=[b[c]]}!(b[c]instanceof Array)&&a.arrayAccessFormPaths.length>0&&j(a.arrayAccessFormPaths,b,c,d)&&(b[c]=[b[c]])}function l(a){var b=a.split(/[-T:+Z]/g),c=new Date(b[0],b[1]-1,b[2]),d=b[5].split(".");if(c.setHours(b[3],b[4],d[0]),d.length>1&&c.setMilliseconds(d[1]),b[6]&&b[7]){var e=60*b[6]+Number(b[7]),f=/\d\d-\d\d:\d\d$/.test(a)?"-":"+";e=0+("-"==f?-1*e:e),c.setMinutes(c.getMinutes()-e-c.getTimezoneOffset())}else a.indexOf("Z",a.length-1)!==-1&&(c=new Date(Date.UTC(c.getFullYear(),c.getMonth(),c.getDate(),c.getHours(),c.getMinutes(),c.getSeconds(),c.getMilliseconds())));return c}function m(b,c,d){if(a.datetimeAccessFormPaths.length>0){var e=d.split(".#")[0];return j(a.datetimeAccessFormPaths,b,c,e)?l(b):b}return b}function n(b,c,e,f){return!(c==d.ELEMENT_NODE&&a.xmlElementsFilter.length>0)||j(a.xmlElementsFilter,b,e,f)}function o(b,c){if(b.nodeType==d.DOCUMENT_NODE){for(var e=new Object,h=b.childNodes,i=0;i<h.length;i++){var j=h.item(i);if(j.nodeType==d.ELEMENT_NODE){var l=f(j);e[l]=o(j,l)}}return e}if(b.nodeType==d.ELEMENT_NODE){var e=new Object;e.__cnt=0;for(var h=b.childNodes,i=0;i<h.length;i++){var j=h.item(i),l=f(j);if(j.nodeType!=d.COMMENT_NODE){var p=c+"."+l;n(e,j.nodeType,l,p)&&(e.__cnt++,null==e[l]?(e[l]=o(j,p),k(e,l,p)):(null!=e[l]&&(e[l]instanceof Array||(e[l]=[e[l]],k(e,l,p))),e[l][e[l].length]=o(j,p)))}}for(var q=0;q<b.attributes.length;q++){var r=b.attributes.item(q);e.__cnt++,e[a.attributePrefix+r.name]=r.value}var s=g(b);return null!=s&&""!=s&&(e.__cnt++,e.__prefix=s),null!=e["#text"]&&(e.__text=e["#text"],e.__text instanceof Array&&(e.__text=e.__text.join("\n")),a.stripWhitespaces&&(e.__text=e.__text.trim()),delete e["#text"],"property"==a.arrayAccessForm&&delete e["#text_asArray"],e.__text=m(e.__text,l,c+"."+l)),null!=e["#cdata-section"]&&(e.__cdata=e["#cdata-section"],delete e["#cdata-section"],"property"==a.arrayAccessForm&&delete e["#cdata-section_asArray"]),0==e.__cnt&&"text"==a.emptyNodeForm?e="":1==e.__cnt&&null!=e.__text?e=e.__text:1!=e.__cnt||null==e.__cdata||a.keepCData?e.__cnt>1&&null!=e.__text&&a.skipEmptyTextNodesForObj&&(a.stripWhitespaces&&""==e.__text||""==e.__text.trim())&&delete e.__text:e=e.__cdata,delete e.__cnt,!a.enableToStringFunc||null==e.__text&&null==e.__cdata||(e.toString=function(){return(null!=this.__text?this.__text:"")+(null!=this.__cdata?this.__cdata:"")}),e}if(b.nodeType==d.TEXT_NODE||b.nodeType==d.CDATA_SECTION_NODE)return b.nodeValue}function p(b,c,d,e){var f="<"+(null!=b&&null!=b.__prefix?b.__prefix+":":"")+c;if(null!=d)for(var g=0;g<d.length;g++){var i=d[g],j=b[i];a.escapeMode&&(j=h(j)),f+=" "+i.substr(a.attributePrefix.length)+"=",f+=a.useDoubleQuotes?'"'+j+'"':"'"+j+"'"}return f+=e?"/>":">"}function q(a,b){return"</"+(null!=a.__prefix?a.__prefix+":":"")+b+">"}function r(a,b){return a.indexOf(b,a.length-b.length)!==-1}function s(b,c){return!!("property"==a.arrayAccessForm&&r(c.toString(),"_asArray")||0==c.toString().indexOf(a.attributePrefix)||0==c.toString().indexOf("__")||b[c]instanceof Function)}function t(a){var b=0;if(a instanceof Object)for(var c in a)s(a,c)||b++;return b}function u(b,c,d){return 0==a.jsonPropertiesFilter.length||""==d||j(a.jsonPropertiesFilter,b,c,d)}function v(b){var c=[];if(b instanceof Object)for(var d in b)d.toString().indexOf("__")==-1&&0==d.toString().indexOf(a.attributePrefix)&&c.push(d);return c}function w(b){var c="";return null!=b.__cdata&&(c+="<![CDATA["+b.__cdata+"]]>"),null!=b.__text&&(c+=a.escapeMode?h(b.__text):b.__text),c}function x(b){var c="";return b instanceof Object?c+=w(b):null!=b&&(c+=a.escapeMode?h(b):b),c}function y(a,b){return""===a?b:a+"."+b}function z(a,b,c,d){var e="";if(0==a.length)e+=p(a,b,c,!0);else for(var f=0;f<a.length;f++)e+=p(a[f],b,v(a[f]),!1),e+=A(a[f],y(d,b)),e+=q(a[f],b);return e}function A(a,b){var c="",d=t(a);if(d>0)for(var e in a)if(!s(a,e)&&(""==b||u(a,e,y(b,e)))){var f=a[e],g=v(f);if(null==f||void 0==f)c+=p(f,e,g,!0);else if(f instanceof Object)if(f instanceof Array)c+=z(f,e,g,b);else if(f instanceof Date)c+=p(f,e,g,!1),c+=f.toISOString(),c+=q(f,e);else{var h=t(f);h>0||null!=f.__text||null!=f.__cdata?(c+=p(f,e,g,!1),c+=A(f,y(b,e)),c+=q(f,e)):c+=p(f,e,g,!0)}else c+=p(f,e,g,!1),c+=x(f),c+=q(f,e)}return c+=x(a)}var b="1.2.0";a=a||{},c(),e();var d={ELEMENT_NODE:1,TEXT_NODE:3,CDATA_SECTION_NODE:4,COMMENT_NODE:8,DOCUMENT_NODE:9};this.parseXmlString=function(a){var b=window.ActiveXObject||"ActiveXObject"in window;if(void 0===a)return null;var c;if(window.DOMParser){var d=new window.DOMParser,e=null;if(!b)try{e=d.parseFromString("INVALID","text/xml").getElementsByTagName("parsererror")[0].namespaceURI}catch(a){e=null}try{c=d.parseFromString(a,"text/xml"),null!=e&&c.getElementsByTagNameNS(e,"parsererror").length>0&&(c=null)}catch(a){c=null}}else 0==a.indexOf("<?")&&(a=a.substr(a.indexOf("?>")+2)),c=new ActiveXObject("Microsoft.XMLDOM"),c.async="false",c.loadXML(a);return c},this.asArray=function(a){return void 0===a||null==a?[]:a instanceof Array?a:[a]},this.toXmlDateTime=function(a){return a instanceof Date?a.toISOString():"number"==typeof a?new Date(a).toISOString():null},this.asDateTime=function(a){return"string"==typeof a?l(a):a},this.xml2json=function(a){return o(a)},this.xml_str2json=function(a){var b=this.parseXmlString(a);return null!=b?this.xml2json(b):null},this.json2xml_str=function(a){return A(a,"")},this.json2xml=function(a){var b=this.json2xml_str(a);return this.parseXmlString(b)},this.getVersion=function(){return b}}});